## 参数辨识

### 可辨识性和输入激励

参数辨识是指学习系统动力学的过程。如果我们定义某种模型拟合度量，我们可以通过优化该度量来确定模型参数的真实值。由于我们主要关注摆杆角度，一个候选的度量标准可以是 $|\theta-\hat{\theta} |$，其中 $\theta$ 是实际系统上的测量值，$\hat{\theta}$ 是模拟输出，当模拟具有与实际系统相同的初始状态并由相同的控制信号驱动时。

显然，如果我们从静止状态开始并且不施加控制信号，无论我们选择什么参数值，我们都会有 $|\theta-\hat{\theta} |=0$。这是因为我们的实验没有激励系统动力学。因此，我们需要考虑进行什么样的实验。特别是在存在噪声（和其他干扰）的情况下，我们的实验需要使我们的模型拟合度量对远离真实参数值的变化（相对）敏感，但对作用于系统的干扰（相对）不敏感。



### 线性化的摆臂子系统

让我们从估计摆臂子系统的参数开始。通过施加一个控制信号脉冲给摆动一个小的"推动"，使其开始振荡，但保持脉冲幅度足够低，以避免与基座动力学的大量耦合：也就是说，保持振幅足够低，使基座不会过分振荡。同时保持振幅足够低，使得近似 $\sin\phi\approx\phi$ 成立，从而可以使用线性化模型。

此时，您应该已经得到了具有粘滞摩擦的摆臂子系统的线性化模型，其形式为 $\ddot{\theta}=-a_0\theta-a_1\dot{\theta}$，其中 $a_0$ 和 $a_1$ 是待确定的参数。这是一个阻尼谐振子的微分方程。其角频率由 $\omega=\sqrt{a_0-a_1^2/4}$ 给出。您可以自行推导这个表达式，或者在这里查找[这里](https://opentextbc.ca/universityphysicsv1openstax/chapter/15-5-damped-oscillations/)。

从实验输出中选择出振荡周期，并用它来计算角频率。这还不足以唯一确定 $a_0$ 和 $a_1$。为了做到这一点，我们还需要考虑阻尼。阻尼提供了由指数衰减 $\exp(-ta_1/2)$ 确定的振荡信号的包络。从实验数据中选择峰值，对其幅度取对数，并拟合形式为 $kt+m$ 的直线（使用普通最小二乘法），将为您提供 $k=-a_1/2$。现在您已经有了确定摆臂子系统参数的所有必要信息。



### 线性化的基座子系统

对于基座子系统，让我们从确定粘滞摩擦参数开始。与摆臂子系统不同，我们可以直接对基座进行驱动。构造一个看起来像阶梯的控制信号，并让每个阶梯足够长，使得角速度稳定下来。现在您有了一些控制信号水平和相应的基座角速度。在隔离基座动力学的情况下，组合的摩擦和反电动势模型将为 $\ddot{\varphi} = -K_f\dot{\varphi} + B_2 u$，其中 $K_f$ 模拟了电机反电动势和粘滞摩擦。请注意，我们在这里忽略了 $A_{23}$ 项，因为我们将在线性化模型中将其设置为零，理由是摆臂角度的影响必须远小于电机（$B_2$）和摩擦（$K_f$）项的影响。

建立一个线性回归问题，给出在给定 $B_2$ 的情况下估计 $K_f$ 的方法。反过来，可以使用线性化的 $B$ 矩阵和给定的参数来计算 $B_2$。将其纳入您的摆动模型中。



### 控制信号模型

通过先前的实验，我们已经确定了系统矩阵 $A$，现在需要确定输入矩阵 $B$。

在线性化模型中，控制信号提供了两个对 $\dot{\phi}$ 和 $\dot{\theta}$ 有贡献的项。但是我们之前不是提到过摆臂上没有外部力矩作用吗？您如何解释对 $\dot{\theta}$ 的贡献？



根据您在上面得到的初始参数值，开始使用相应的 $B$ 矩阵。在线性化模型是有效近似的下降平衡点附近进行系统模拟。手动调整 $B$ 矩阵的相关元素，以找到尽可能好的拟合效果。